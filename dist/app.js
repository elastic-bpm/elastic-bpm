"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/*jshint esversion: 6 */
require("source-map-support/register");
const express = require('express'), app = express();
const bodyParser = require('body-parser');
app.use(bodyParser.json());
const server = require('http').createServer(app);
const workflows_1 = require("./components/workflows");
const workflows = new workflows_1.Workflow();
const redis_1 = require("./components/redis");
const redis = new redis_1.Redis();
const docker_1 = require("./components/docker");
const docker = new docker_1.Docker();
const human_1 = require("./components/human");
const human = new human_1.Human();
const scaling_1 = require("./components/scaling");
const scaling = new scaling_1.Scaling();
const scheduler_1 = require("./components/scheduler");
const scheduler = new scheduler_1.Scheduler();
const elastic_1 = require("./components/elastic");
const elastic = new elastic_1.Elastic();
const os = require('os');
const log4js = require('log4js');
log4js.configure({
    appenders: [
        { type: 'console' },
        {
            host: '137.116.195.67',
            port: 12201,
            type: 'gelf',
            hostname: 'elastic-dashboard-api@' + os.hostname(),
            layout: {
                type: 'pattern',
                pattern: '%m'
            },
            category: ['console']
        }
    ],
    replaceConsole: true
});
const return_status = function (status, req, res) {
    res.setHeader('Content-Type', 'application/json');
    res.status(status.statusCode).send(status.message);
};
const return_json = function (json, req, res) {
    res.setHeader('Content-Type', 'application/json');
    res.send(JSON.stringify(json, null, 2));
};
const create_workflows_from_file = function (req, res) {
    workflows.create_workflows_from_file(req, (error, data) => {
        if (error) {
            res.status(500).send(error);
        }
        else {
            console.log(data);
            res.send(JSON.stringify(data, null, 2));
        }
        ;
    });
};
const delete_workflow = function (req, res) {
    workflows.delete_workflow(req.params['workflow_id'], (error, data) => {
        if (error) {
            res.status(500).send(error);
        }
        else {
            res.send(JSON.stringify(data, null, 2));
        }
        ;
    });
};
const set_node_availability = function (req, res) {
    docker.set_node_availability(req.params['hostname'], req.params['availability'], (error, data) => {
        if (error) {
            res.status(500).send(error);
        }
        else {
            res.send(JSON.stringify(data, null, 2));
        }
        ;
    });
};
const start_virtualmachine = function (req, res) {
    scaling.start_virtualmachine(req.params['resourcegroup'], req.params['machine_id'], (error, data) => {
        if (error) {
            res.status(500).send(error);
        }
        else {
            res.send(JSON.stringify(data, null, 2));
        }
        ;
    });
};
const stop_virtualmachine = function (req, res) {
    scaling.stop_virtualmachine(req.params['resourcegroup'], req.params['machine_id'], (error, data) => {
        if (error) {
            res.status(500).send(error);
        }
        else {
            res.send(JSON.stringify(data, null, 2));
        }
        ;
    });
};
// ROUTING
const setup_routes = function () {
    app.get('/api/redis/status', (req, res) => return_status(redis.check_status(), req, res));
    app.get('/api/workflow/status', (req, res) => return_status(workflows.check_status(), req, res));
    app.get('/api/workflow/workflows', (req, res) => return_json(workflows.get_workflows(), req, res));
    app.post('/api/workflow/workflows', (req, res) => return_json_post(workflows.create_workflow, req, res));
    app.delete('/api/workflow/workflows', (req, res) => return_json_post(workflows.delete_all_workflows, req, res));
    app.delete('/api/workflow/workflows/:workflow_id', (req, res) => delete_workflow(req, res));
    app.post('/api/workflow/workflows/file', (req, res) => create_workflows_from_file(req, res));
    app.get('/api/docker/status', (req, res) => return_status(docker.check_status(), req, res));
    app.get('/api/docker/info/remote', (req, res) => return_json(docker.get_remote_info(), req, res));
    app.get('/api/docker/containers/remote', (req, res) => return_json(docker.get_remote_containers(), req, res));
    app.get('/api/docker/services/remote', (req, res) => return_json(docker.get_remote_services(), req, res));
    app.post('/api/docker/services/workers', (req, res) => return_json_post(docker.create_workers, req, res));
    app.delete('/api/docker/services/workers', (req, res) => return_json_post(docker.delete_workers, req, res));
    app.get('/api/docker/nodes', (req, res) => return_json(docker.get_nodes(), req, res));
    app.post('/api/docker/nodes/:hostname/:availability', set_node_availability);
    app.get('/api/docker/workers', (req, res) => return_json(docker.get_workers(), req, res));
    app.get('/api/human/status', (req, res) => return_status(human.check_status(), req, res));
    app.get('/api/human/info', (req, res) => return_json(human.get_info(), req, res));
    app.post('/api/human/start', (req, res) => return_json_post(human.start_humans, req, res));
    app.post('/api/human/stop', (req, res) => return_json_post(human.stop_humans, req, res));
    app.get('/api/scaling/status', (req, res) => return_status(scaling.check_status(), req, res));
    app.get('/api/scaling/virtualmachines', (req, res) => return_json(scaling.get_virtualmachines(), req, res));
    app.post('/api/scaling/virtualmachines/:resourcegroup/:machine_id/start', start_virtualmachine);
    app.post('/api/scaling/virtualmachines/:resourcegroup/:machine_id/stop', stop_virtualmachine);
    app.get('/api/scheduler/status', (req, res) => return_status(scheduler.check_status(), req, res));
    app.get('/api/scheduler/info', (req, res) => return_json(scheduler.get_info(), req, res));
    app.get('/api/scheduler/tasks/human', (req, res) => return_json(scheduler.get_human_tasks(), req, res));
    app.post('/api/scheduler/task', (req, res) => return_json_post(scheduler.set_human_task, req, res));
    app.post('/api/scheduler/policy', (req, res) => return_json_post(scheduler.set_policy, req, res));
    app.post('/api/scheduler/amount', (req, res) => return_json_post(scheduler.set_amount, req, res));
    app.post('/api/scheduler/execute', (req, res) => return_json_post(scheduler.execute, req, res));
    app.get('/api/elastic/status', (req, res) => return_status(elastic.check_status(), req, res));
    app.get('/api/elastic/logs', (req, res) => return_json(elastic.get_messages(), req, res));
    app.get('/api/elastic/load', (req, res) => return_json(elastic.get_load(), req, res));
};
const start_check_status = function () {
    redis.update_status(2000);
    scheduler.start_updates(2000);
    workflows.start_updates(2000);
    docker.start_updates(10000); // 10sec for docker
    human.start_updates(2000);
    scaling.start_updates(2000);
    elastic.start_updates(2000);
};
// Server startup
const start_server = function () {
    server.listen(8080, () => console.log('Elastic-dashboard-api listening on port 8080!'));
};
// When run directly, serve the API
if (require.main === module) {
    setup_routes();
    start_server();
    start_check_status();
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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R0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xCLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDNUMsQ0FBQztRQUFBLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQztBQUVGLE1BQU0sZUFBZSxHQUFHLFVBQVUsR0FBUSxFQUFFLEdBQVE7SUFDaEQsU0FBUyxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsS0FBVSxFQUFFLElBQVM7UUFDdkUsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztZQUNSLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2hDLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNKLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDNUMsQ0FBQztRQUFBLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQztBQUVGLE1BQU0scUJBQXFCLEdBQUcsVUFBVSxHQUFRLEVBQUUsR0FBUTtJQUN0RCxNQUFNLENBQUMscUJBQXFCLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUMsS0FBVSxFQUFFLElBQVM7UUFDbkcsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztZQUNSLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2hDLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNKLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNB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Q0FBQyxDQUFDO0FBQ2hDLENBQUMsQ0FBQztBQUVGLGlCQUFpQjtBQUNqQixNQUFNLFlBQVksR0FBRztJQUNqQixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsK0NBQStDLENBQUMsQ0FBQyxDQUFDO0FBQzVGLENBQUMsQ0FBQztBQUVGLG1DQUFtQztBQUNuQyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDMUIsWUFBWSxFQUFFLENBQUM7SUFDZixZQUFZLEVBQUUsQ0FBQztJQUNmLGtCQUFrQixFQUFFLENBQUM7QUFDekIsQ0FBQyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKmpzaGludCBlc3ZlcnNpb246IDYgKi9cclxuaW1wb3J0ICdzb3VyY2UtbWFwLXN1cHBvcnQvcmVnaXN0ZXInO1xyXG5jb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpLFxyXG4gICAgYXBwID0gZXhwcmVzcygpO1xyXG5cclxuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XHJcbmFwcC51c2UoYm9keVBhcnNlci5qc29uKCkpO1xyXG5cclxuY29uc3Qgc2VydmVyID0gcmVxdWlyZSgnaHR0cCcpLmNyZWF0ZVNlcnZlcihhcHApO1xyXG5cclxuaW1wb3J0IHsgV29ya2Zsb3cgfSBmcm9tICcuL2NvbXBvbmVudHMvd29ya2Zsb3dzJztcclxuY29uc3Qgd29ya2Zsb3dzID0gbmV3IFdvcmtmbG93KCk7XHJcblxyXG5pbXBvcnQgeyBSZWRpcyB9IGZyb20gJy4vY29tcG9uZW50cy9yZWRpcyc7XHJcbmNvbnN0IHJlZGlzID0gbmV3IFJlZGlzKCk7XHJcblxyXG5pbXBvcnQgeyBEb2NrZXIgfSBmcm9tICcuL2NvbXBvbmVudHMvZG9ja2VyJztcclxuY29uc3QgZG9ja2VyID0gbmV3IERvY2tlcigpO1xyXG5cclxuaW1wb3J0IHsgSHVtYW4gfSBmcm9tICcuL2NvbXBvbmVudHMvaHVtYW4nO1xyXG5jb25zdCBodW1hbiA9IG5ldyBIdW1hbigpO1xyXG5cclxuaW1wb3J0IHsgU2NhbGluZyB9IGZyb20gJy4vY29tcG9uZW50cy9zY2FsaW5nJztcclxuY29uc3Qgc2NhbGluZyA9IG5ldyBTY2FsaW5nKCk7XHJcblxyXG5pbXBvcnQgeyBTY2hlZHVsZXIgfSBmcm9tICcuL2NvbXBvbmVudHMvc2NoZWR1bGVyJztcclxuY29uc3Qgc2NoZWR1bGVyID0gbmV3IFNjaGVkdWxlcigpO1xyXG5cclxuaW1wb3J0IHsgRWxhc3RpYyB9IGZyb20gJy4vY29tcG9uZW50cy9lbGFzdGljJztcclxuY29uc3QgZWxhc3RpYyA9IG5ldyBFbGFzdGljKCk7XHJcblxyXG5jb25zdCBvcyA9IHJlcXVpcmUoJ29zJyk7XHJcbmNvbnN0IGxvZzRqcyA9IHJlcXVpcmUoJ2xvZzRqcycpO1xyXG5sb2c0anMuY29uZmlndXJlKHtcclxuICAgIGFwcGVuZGVyczogW1xyXG4gICAgICAgIHsgdHlwZTogJ2NvbnNvbGUnIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBob3N0OiAnMTM3LjExNi4xOTUuNjcnLFxyXG4gICAgICAgICAgICBwb3J0OiAxMjIwMSxcclxuICAgICAgICAgICAgdHlwZTogJ2dlbGYnLFxyXG4gICAgICAgICAgICBob3N0bmFtZTogJ2VsYXN0aWMtZGFzaGJvYXJkLWFwaUAnICsgb3MuaG9zdG5hbWUoKSxcclxuICAgICAgICAgICAgbGF5b3V0OiB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiAncGF0dGVybicsXHJcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnJW0nXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNhdGVnb3J5OiBbJ2NvbnNvbGUnXVxyXG4gICAgICAgIH1cclxuICAgIF0sXHJcbiAgICByZXBsYWNlQ29uc29sZTogdHJ1ZVxyXG59KTtcclxuXHJcbmNvbnN0IHJldHVybl9zdGF0dXMgPSBmdW5jdGlvbiAoc3RhdHVzOiBhbnksIHJlcTogYW55LCByZXM6IGFueSkge1xyXG4gICAgcmVzLnNldEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcclxuICAgIHJlcy5zdGF0dXMoc3RhdHVzLnN0YXR1c0NvZGUpLnNlbmQoc3RhdHVzLm1lc3NhZ2UpO1xyXG59O1xyXG5cclxuY29uc3QgcmV0dXJuX2pzb24gPSBmdW5jdGlvbiAoanNvbjogYW55LCByZXE6IGFueSwgcmVzOiBhbnkpIHtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XHJcbiAgICByZXMuc2VuZChKU09OLnN0cmluZ2lmeShqc29uLCBudWxsLCAyKSk7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVfd29ya2Zsb3dzX2Zyb21fZmlsZSA9IGZ1bmN0aW9uIChyZXE6IGFueSwgcmVzOiBhbnkpIHtcclxuICAgIHdvcmtmbG93cy5jcmVhdGVfd29ya2Zsb3dzX2Zyb21fZmlsZShyZXEsIChlcnJvcjogYW55LCBkYXRhOiBhbnkpID0+IHtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICByZXMuc2VuZChKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKSk7XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuY29uc3QgZGVsZXRlX3dvcmtmbG93ID0gZnVuY3Rpb24gKHJlcTogYW55LCByZXM6IGFueSkge1xyXG4gICAgd29ya2Zsb3dzLmRlbGV0ZV93b3JrZmxvdyhyZXEucGFyYW1zWyd3b3JrZmxvd19pZCddLCAoZXJyb3I6IGFueSwgZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXMuc2VuZChKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKSk7XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0X25vZGVfYXZhaWxhYmlsaXR5ID0gZnVuY3Rpb24gKHJlcTogYW55LCByZXM6IGFueSkge1xyXG4gICAgZG9ja2VyLnNldF9ub2RlX2F2YWlsYWJpbGl0eShyZXEucGFyYW1zWydob3N0bmFtZSddLCByZXEucGFyYW1zWydhdmFpbGFiaWxpdHknXSwgKGVycm9yOiBhbnksIGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuc2VuZChlcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVzLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHN0YXJ0X3ZpcnR1YWxtYWNoaW5lID0gZnVuY3Rpb24gKHJlcTogYW55LCByZXM6IGFueSkge1xyXG4gICAgc2NhbGluZy5zdGFydF92aXJ0dWFsbWFjaGluZShyZXEucGFyYW1zWydyZXNvdXJjZWdyb3VwJ10sIHJlcS5wYXJhbXNbJ21hY2hpbmVfaWQnXSwgKGVycm9yOiBhbnksIGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuc2VuZChlcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVzLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHN0b3BfdmlydHVhbG1hY2hpbmUgPSBmdW5jdGlvbiAocmVxOiBhbnksIHJlczogYW55KSB7XHJcbiAgICBzY2FsaW5nLnN0b3BfdmlydHVhbG1hY2hpbmUocmVxLnBhcmFtc1sncmVzb3VyY2Vncm91cCddLCByZXEucGFyYW1zWydtYWNoaW5lX2lkJ10sIChlcnJvcjogYW55LCBkYXRhOiBhbnkpID0+IHtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlcy5zZW5kKEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG4vLyBST1VUSU5HXHJcbmNvbnN0IHNldHVwX3JvdXRlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGFwcC5nZXQoJy9hcGkvcmVkaXMvc3RhdHVzJywgKHJlcTogYW55LCByZXM6IGFueSkgPT4gcmV0dXJuX3N0YXR1cyhyZWRpcy5jaGVja19zdGF0dXMoKSwgcmVxLCByZXMpKTtcclxuXHJcbiAgICBhcHAuZ2V0KCcvYXBpL3dvcmtmbG93L3N0YXR1cycsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9zdGF0dXMod29ya2Zsb3dzLmNoZWNrX3N0YXR1cygpLCByZXEsIHJlcykpO1xyXG4gICAgYXBwLmdldCgnL2FwaS93b3JrZmxvdy93b3JrZmxvd3MnLCAocmVxOiBhbnksIHJlczogYW55KSA9PiByZXR1cm5fanNvbih3b3JrZmxvd3MuZ2V0X3dvcmtmbG93cygpLCByZXEsIHJlcykpO1xyXG4gICAgYXBwLnBvc3QoJy9hcGkvd29ya2Zsb3cvd29ya2Zsb3dzJywgKHJlcTogYW55LCByZXM6IGFueSkgPT4gcmV0dXJuX2pzb25fcG9zdCh3b3JrZmxvd3MuY3JlYXRlX3dvcmtmbG93LCByZXEsIHJlcykpO1xyXG4gICAgYXBwLmRlbGV0ZSgnL2FwaS93b3JrZmxvdy93b3JrZmxvd3MnLCAocmVxOiBhbnksIHJlczogYW55KSA9PiByZXR1cm5fanNvbl9wb3N0KHdvcmtmbG93cy5kZWxldGVfYWxsX3dvcmtmbG93cywgcmVxLCByZXMpKTtcclxuICAgIGFwcC5kZWxldGUoJy9hcGkvd29ya2Zsb3cvd29ya2Zsb3dzLzp3b3JrZmxvd19pZCcsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IGRlbGV0ZV93b3JrZmxvdyhyZXEsIHJlcykpO1xyXG4gICAgYXBwLnBvc3QoJy9hcGkvd29ya2Zsb3cvd29ya2Zsb3dzL2ZpbGUnLCAocmVxOiBhbnksIHJlczogYW55KSA9PiBjcmVhdGVfd29ya2Zsb3dzX2Zyb21fZmlsZShyZXEsIHJlcykpO1xyXG5cclxuICAgIGFwcC5nZXQoJy9hcGkvZG9ja2VyL3N0YXR1cycsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9zdGF0dXMoZG9ja2VyLmNoZWNrX3N0YXR1cygpLCByZXEsIHJlcykpO1xyXG4gICAgYXBwLmdldCgnL2FwaS9kb2NrZXIvaW5mby9yZW1vdGUnLCAocmVxOiBhbnksIHJlczogYW55KSA9PiByZXR1cm5fanNvbihkb2NrZXIuZ2V0X3JlbW90ZV9pbmZvKCksIHJlcSwgcmVzKSk7XHJcbiAgICBhcHAuZ2V0KCcvYXBpL2RvY2tlci9jb250YWluZXJzL3JlbW90ZScsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uKGRvY2tlci5nZXRfcmVtb3RlX2NvbnRhaW5lcnMoKSwgcmVxLCByZXMpKTtcclxuICAgIGFwcC5nZXQoJy9hcGkvZG9ja2VyL3NlcnZpY2VzL3JlbW90ZScsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uKGRvY2tlci5nZXRfcmVtb3RlX3NlcnZpY2VzKCksIHJlcSwgcmVzKSk7XHJcblxyXG4gICAgYXBwLnBvc3QoJy9hcGkvZG9ja2VyL3NlcnZpY2VzL3dvcmtlcnMnLCAocmVxOiBhbnksIHJlczogYW55KSA9PiByZXR1cm5fanNvbl9wb3N0KGRvY2tlci5jcmVhdGVfd29ya2VycywgcmVxLCByZXMpKTtcclxuICAgIGFwcC5kZWxldGUoJy9hcGkvZG9ja2VyL3NlcnZpY2VzL3dvcmtlcnMnLCAocmVxOiBhbnksIHJlczogYW55KSA9PiByZXR1cm5fanNvbl9wb3N0KGRvY2tlci5kZWxldGVfd29ya2VycywgcmVxLCByZXMpKTtcclxuXHJcbiAgICBhcHAuZ2V0KCcvYXBpL2RvY2tlci9ub2RlcycsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uKGRvY2tlci5nZXRfbm9kZXMoKSwgcmVxLCByZXMpKTtcclxuICAgIGFwcC5wb3N0KCcvYXBpL2RvY2tlci9ub2Rlcy86aG9zdG5hbWUvOmF2YWlsYWJpbGl0eScsIHNldF9ub2RlX2F2YWlsYWJpbGl0eSk7XHJcblxyXG4gICAgYXBwLmdldCgnL2FwaS9kb2NrZXIvd29ya2VycycsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uKGRvY2tlci5nZXRfd29ya2VycygpLCByZXEsIHJlcykpO1xyXG5cclxuICAgIGFwcC5nZXQoJy9hcGkvaHVtYW4vc3RhdHVzJywgKHJlcTogYW55LCByZXM6IGFueSkgPT4gcmV0dXJuX3N0YXR1cyhodW1hbi5jaGVja19zdGF0dXMoKSwgcmVxLCByZXMpKTtcclxuICAgIGFwcC5nZXQoJy9hcGkvaHVtYW4vaW5mbycsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uKGh1bWFuLmdldF9pbmZvKCksIHJlcSwgcmVzKSk7XHJcbiAgICBhcHAucG9zdCgnL2FwaS9odW1hbi9zdGFydCcsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uX3Bvc3QoaHVtYW4uc3RhcnRfaHVtYW5zLCByZXEsIHJlcykpO1xyXG4gICAgYXBwLnBvc3QoJy9hcGkvaHVtYW4vc3RvcCcsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uX3Bvc3QoaHVtYW4uc3RvcF9odW1hbnMsIHJlcSwgcmVzKSk7XHJcblxyXG4gICAgYXBwLmdldCgnL2FwaS9zY2FsaW5nL3N0YXR1cycsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9zdGF0dXMoc2NhbGluZy5jaGVja19zdGF0dXMoKSwgcmVxLCByZXMpKTtcclxuICAgIGFwcC5nZXQoJy9hcGkvc2NhbGluZy92aXJ0dWFsbWFjaGluZXMnLCAocmVxOiBhbnksIHJlczogYW55KSA9PiByZXR1cm5fanNvbihzY2FsaW5nLmdldF92aXJ0dWFsbWFjaGluZXMoKSwgcmVxLCByZXMpKTtcclxuICAgIGFwcC5wb3N0KCcvYXBpL3NjYWxpbmcvdmlydHVhbG1hY2hpbmVzLzpyZXNvdXJjZWdyb3VwLzptYWNoaW5lX2lkL3N0YXJ0Jywgc3RhcnRfdmlydHVhbG1hY2hpbmUpO1xyXG4gICAgYXBwLnBvc3QoJy9hcGkvc2NhbGluZy92aXJ0dWFsbWFjaGluZXMvOnJlc291cmNlZ3JvdXAvOm1hY2hpbmVfaWQvc3RvcCcsIHN0b3BfdmlydHVhbG1hY2hpbmUpO1xyXG5cclxuICAgIGFwcC5nZXQoJy9hcGkvc2NoZWR1bGVyL3N0YXR1cycsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9zdGF0dXMoc2NoZWR1bGVyLmNoZWNrX3N0YXR1cygpLCByZXEsIHJlcykpO1xyXG4gICAgYXBwLmdldCgnL2FwaS9zY2hlZHVsZXIvaW5mbycsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uKHNjaGVkdWxlci5nZXRfaW5mbygpLCByZXEsIHJlcykpO1xyXG4gICAgYXBwLmdldCgnL2FwaS9zY2hlZHVsZXIvdGFza3MvaHVtYW4nLCAocmVxOiBhbnksIHJlczogYW55KSA9PiByZXR1cm5fanNvbihzY2hlZHVsZXIuZ2V0X2h1bWFuX3Rhc2tzKCksIHJlcSwgcmVzKSk7XHJcbiAgICBhcHAucG9zdCgnL2FwaS9zY2hlZHVsZXIvdGFzaycsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uX3Bvc3Qoc2NoZWR1bGVyLnNldF9odW1hbl90YXNrLCByZXEsIHJlcykpO1xyXG4gICAgYXBwLnBvc3QoJy9hcGkvc2NoZWR1bGVyL3BvbGljeScsIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHJldHVybl9qc29uX3Bvc3Qoc2NoZWR1bGVyLnNldF9wb2xpY3ksIHJlcSwgcmVzKSk7XHJcbiAgICBhcHAucG9zdCgnL2FwaS9zY2hlZHVsZXIvYW1vdW50JywgKHJlcTogYW55LCByZXM6IGFueSkgPT4gcmV0dXJuX2pzb25fcG9zdChzY2hlZHVsZXIuc2V0X2Ftb3VudCwgcmVxLCByZXMpKTtcclxuICAgIGFwcC5wb3N0KCcvYXBpL3NjaGVkdWxlci9leGVjdXRlJywgKHJlcTogYW55LCByZXM6IGFueSkgPT4gcmV0dXJuX2pzb25fcG9zdChzY2hlZHVsZXIuZXhlY3V0ZSwgcmVxLCByZXMpKTtcclxuXHJcbiAgICBhcHAuZ2V0KCcvYXBpL2VsYXN0aWMvc3RhdHVzJywgKHJlcTogYW55LCByZXM6IGFueSkgPT4gcmV0dXJuX3N0YXR1cyhlbGFzdGljLmNoZWNrX3N0YXR1cygpLCByZXEsIHJlcykpO1xyXG4gICAgYXBwLmdldCgnL2FwaS9lbGFzdGljL2xvZ3MnLCAocmVxOiBhbnksIHJlczogYW55KSA9PiByZXR1cm5fanNvbihlbGFzdGljLmdldF9tZXNzYWdlcygpLCByZXEsIHJlcykpO1xyXG4gICAgYXBwLmdldCgnL2FwaS9lbGFzdGljL2xvYWQnLCAocmVxOiBhbnksIHJlczogYW55KSA9PiByZXR1cm5fanNvbihlbGFzdGljLmdldF9sb2FkKCksIHJlcSwgcmVzKSk7XHJcbn07XHJcblxyXG5jb25zdCBzdGFydF9jaGVja19zdGF0dXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZWRpcy51cGRhdGVfc3RhdHVzKDIwMDApO1xyXG5cclxuICAgIHNjaGVkdWxlci5zdGFydF91cGRhdGVzKDIwMDApO1xyXG4gICAgd29ya2Zsb3dzLnN0YXJ0X3VwZGF0ZXMoMjAwMCk7XHJcbiAgICBkb2NrZXIuc3RhcnRfdXBkYXRlcygxMDAwMCk7IC8vIDEwc2VjIGZvciBkb2NrZXJcclxuICAgIGh1bWFuLnN0YXJ0X3VwZGF0ZXMoMjAwMCk7XHJcbiAgICBzY2FsaW5nLnN0YXJ0X3VwZGF0ZXMoMjAwMCk7XHJcbiAgICBlbGFzdGljLnN0YXJ0X3VwZGF0ZXMoMjAwMCk7XHJcbn07XHJcblxyXG4vLyBTZXJ2ZXIgc3RhcnR1cFxyXG5jb25zdCBzdGFydF9zZXJ2ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBzZXJ2ZXIubGlzdGVuKDgwODAsICgpID0+IGNvbnNvbGUubG9nKCdFbGFzdGljLWRhc2hib2FyZC1hcGkgbGlzdGVuaW5nIG9uIHBvcnQgODA4MCEnKSk7XHJcbn07XHJcblxyXG4vLyBXaGVuIHJ1biBkaXJlY3RseSwgc2VydmUgdGhlIEFQSVxyXG5pZiAocmVxdWlyZS5tYWluID09PSBtb2R1bGUpIHtcclxuICAgIHNldHVwX3JvdXRlcygpO1xyXG4gICAgc3RhcnRfc2VydmVyKCk7XHJcbiAgICBzdGFydF9jaGVja19zdGF0dXMoKTtcclxufVxyXG4iXX0=
